<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Dog Booking System{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Dog Booking System is a full-featured pet grooming management app for clients, staff, and managers to manage appointments and services efficiently.">
    <meta name="keywords" content="dog grooming, pet booking, appointment system, grooming salon, Django project">
    <meta name="author" content="Kerem Haeger">
    {% load static %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'core/css/base.css' %}">
    {% block extra_css %}{% endblock %}
    <link rel="icon" type="image/png" href="{% static 'core/images/grooming_icon.png' %}">
</head>

<body>
    {% if user.is_authenticated %}
    <header class="header">
        <div class="header-container">
            <a href="{% url 'redirect_by_role' %}" class="logo" aria-label="Go to Riverdog Studio Homepage">
                Riverdog Studio
            </a>
            <div class="user-info">
                <div class="user-details">
                    Welcome, <strong>{{ user.get_full_name|default:user.username }}</strong>
                    <span class="role-badge">{{ user.userprofile.role|default:"User" }}</span>
                </div>
                <a href="{% url 'logout' %}" class="logout-btn" aria-label="Log out of your account">Logout</a>
            </div>
        </div>
        <nav class="nav">
            <div class="nav-container">
                <ul class="nav-list">
                    {% if user.userprofile.role == 'client' %}
                    <li class="nav-item">
                        <div class="simple-dropdown">
                            <button type="button" class="dropdown-btn" onclick="toggleDropdown('client-menu')">
                                <i class="fas fa-paw"></i> My Pet Care <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="dropdown-content" id="client-menu">
                                <a href="{% url 'client_dashboard' %}" aria-label="Go to My Dashboard">
                                    <i class="fas fa-home"></i> My Dashboard
                                </a>
                                <a href="{% url 'add_pet' %}" aria-label="Go to Add My Pet">
                                    <i class="fas fa-plus"></i> Add My Pet
                                </a>
                                <a href="{% url 'book_appointment' %}" aria-label="Go to Book Grooming">
                                    <i class="fas fa-calendar-plus"></i> Book Grooming
                                </a>
                            </div>
                        </div>
                    </li>
                    {% elif user.userprofile.role == 'employee' %}
                    <li class="nav-item">
                        <div class="simple-dropdown">
                            <button type="button" class="dropdown-btn" onclick="toggleDropdown('employee-menu')">
                                <i class="fas fa-user-tie"></i> Staff Tools <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="dropdown-content" id="employee-menu">
                                <a href="{% url 'employee_dashboard' %}" aria-label="Go to Employee Dashboard">
                                    <i class="fas fa-tachometer-alt"></i> Dashboard
                                </a>
                            </div>
                        </div>
                    </li>
                    {% elif user.userprofile.role == 'manager' %}
                    <li class="nav-item">
                        <div class="simple-dropdown">
                            <button type="button" class="dropdown-btn" onclick="toggleDropdown('manager-menu')">
                                <i class="fas fa-user-cog"></i> Admin Center <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="dropdown-content" id="manager-menu">
                                <a href="{% url 'manager_dashboard' %}" aria-label="Go to Manager Dashboard">
                                    <i class="fas fa-tachometer-alt"></i> Dashboard
                                </a>
                                <a href="{% url 'approve_appointments' %}" aria-label="Go to Manage Appointments">
                                    <i class="fas fa-calendar-check"></i> Manage Appointments
                                    {% if pending_appointments_count > 0 %}
                                    <span class="notification-badge">{{ pending_appointments_count }}</span>
                                    {% endif %}
                                </a>
                                <a href="{% url 'approve_pets' %}" aria-label="Go to Manage Pets">
                                    <i class="fas fa-paw"></i> Manage Pets
                                    {% if pending_pets_count > 0 %}
                                    <span class="notification-badge">{{ pending_pets_count }}</span>
                                    {% endif %}
                                </a>
                                <a href="{% url 'approve_users' %}" aria-label="Go to Manage Users">
                                    <i class="fas fa-users"></i> Manage Users
                                    {% if pending_users_count > 0 %}
                                    <span class="notification-badge">{{ pending_users_count }}</span>
                                    {% endif %}
                                </a>
                                <a href="{% url 'manage_services' %}" aria-label="Go to Manage Services">
                                    <i class="fas fa-cogs"></i> Manage Services
                                </a>
                                <a href="{% url 'create_service' %}" aria-label="Go to Create Service">
                                    <i class="fas fa-plus"></i> Create Service
                                </a>
                            </div>
                        </div>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </nav>
    </header>
    {% endif %}

    <main class="main-content">
        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}
        <!-- Each page overrides this -->
        {% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-left">
                    <span class="footer-logo">Riverdog Studio</span>
                    <span class="footer-separator">•</span>
                    <span class="footer-tagline">Professional Dog Grooming Services</span>
                </div>
                <div class="footer-center">
                    <div class="footer-social">
                        <a href="https://www.facebook.com" target="_blank" rel="noopener noreferrer" class="social-link"
                            aria-label="Go to Facebook">
                            <i class="fa-brands fa-square-facebook"></i>
                        </a>
                        <a href="https://github.com/Kerem-Haeger" target="_blank" rel="noopener noreferrer"
                            class="social-link" aria-label="Go to my Github page">
                            <i class="fa-brands fa-github"></i>
                        </a>
                        <a href="https://www.instagram.com" target="_blank" rel="noopener noreferrer"
                            class="social-link" aria-label="Go to Instagram">
                            <i class="fa-brands fa-instagram"></i>
                        </a>
                    </div>
                </div>
                <div class="footer-right">
                    <a href="https://github.com/Kerem-Haeger" target="_blank" rel="noopener noreferrer"
                        class="creator-link" aria-label="Go to my Github page">
                        <span class="footer-copyright">© 2025 Kerem Haeger</span>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script src="{% static 'core/js/base.js' %}"></script>
    <script>
        // Simple dropdown function that definitely works
        function toggleDropdown(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            const isOpen = dropdown.style.display === 'block';

            // Close all dropdowns first
            const allDropdowns = document.querySelectorAll('.dropdown-content');
            allDropdowns.forEach(d => {
                d.style.display = 'none';
                const btn = d.previousElementSibling;
                if (btn) {
                    btn.classList.remove('active');
                    const chevron = btn.querySelector('.fa-chevron-down');
                    if (chevron) chevron.style.transform = 'rotate(0deg)';
                }
            });

            // Toggle the clicked dropdown
            if (!isOpen) {
                dropdown.style.display = 'block';
                const btn = dropdown.previousElementSibling;
                if (btn) {
                    btn.classList.add('active');
                    const chevron = btn.querySelector('.fa-chevron-down');
                    if (chevron) chevron.style.transform = 'rotate(180deg)';
                }
            }
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function (e) {
            if (!e.target.closest('.simple-dropdown')) {
                const allDropdowns = document.querySelectorAll('.dropdown-content');
                allDropdowns.forEach(d => {
                    d.style.display = 'none';
                    const btn = d.previousElementSibling;
                    if (btn) {
                        btn.classList.remove('active');
                        const chevron = btn.querySelector('.fa-chevron-down');
                        if (chevron) chevron.style.transform = 'rotate(0deg)';
                    }
                });
            }
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>